<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>italkyAI ‚Ä¢ Neon Hangman</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #02000a;
      --neon-pink: #ff00ff;
      --neon-blue: #00f3ff;
      --burgundy: #8b2635;
      --ai-grad: linear-gradient(135deg, #a5b4fc 0%, #6366f1 100%);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
    body { margin: 0; background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; height: 100dvh; overflow: hidden; }

    /* NEON TEXT EFFECT */
    .neon-title {
      font-family: 'Space Grotesk', sans-serif; font-size: 28px; font-weight: 900;
      text-align: center; color: #fff; margin: 10px 0;
      text-shadow: 0 0 5px #fff, 0 0 10px var(--neon-blue), 0 0 20px var(--neon-blue);
      text-transform: uppercase; letter-spacing: 2px;
    }

    .mobile-frame { width: 100%; max-width: 480px; height: 100%; margin: 0 auto; display: flex; flex-direction: column; background: rgba(5, 0, 20, 0.9); position: relative; border: 1px solid rgba(255,255,255,0.05); }

    /* HANGMAN AREA - DAHA B√úY√úK */
    .hangman-area { flex: 0 0 200px; display: flex; align-items: center; justify-content: center; position: relative; padding: 20px; }
    .stage { width: 140px; height: 160px; position: relative; border-bottom: 4px solid #fff; box-shadow: 0 4px 10px var(--neon-blue); }
    .p { position: absolute; background: #fff; display: none; box-shadow: 0 0 8px #fff; }
    .p.show { display: block; }
    .p1 { width: 4px; height: 100%; left: 30px; }
    .p2 { width: 80px; height: 4px; left: 30px; top: 0; }
    .p3 { width: 2px; height: 20px; left: 110px; top: 0; }
    .p4 { width: 34px; height: 34px; border-radius: 50%; border: 4px solid #fff; left: 93px; top: 20px; background: none; }
    .p5 { width: 4px; height: 55px; left: 108px; top: 54px; }
    .p6 { width: 25px; height: 4px; left: 85px; top: 70px; transform: rotate(-30deg); }
    .p7 { width: 25px; height: 4px; left: 108px; top: 70px; transform: rotate(30deg); }
    .p8 { width: 25px; height: 4px; left: 85px; top: 105px; transform: rotate(-45deg); }
    .p9 { width: 25px; height: 4px; left: 108px; top: 105px; transform: rotate(45deg); }

    /* LIVES (KALPLER) */
    .lives-row { display: flex; justify-content: center; gap: 8px; margin: 10px 0; }
    .heart { font-size: 20px; color: var(--neon-pink); filter: drop-shadow(0 0 5px var(--neon-pink)); transition: 0.3s; }
    .heart.lost { opacity: 0.1; filter: grayscale(1); transform: scale(0.8); }

    .word-display { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; padding: 10px 20px; }
    .slot { width: 32px; height: 42px; border-bottom: 3px solid var(--neon-blue); display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 900; }
    .tr-box { text-align: center; font-size: 15px; color: rgba(255,255,255,0.5); font-style: italic; margin-top: 5px; }

    .keyboard { display: grid; grid-template-columns: repeat(6, 1fr); gap: 6px; padding: 15px; margin-top: auto; }
    .key { height: 42px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.05); color: #fff; font-weight: 800; cursor: pointer; font-size: 14px; }
    .key.wrong { background: var(--burgundy); opacity: 0.3; }
    .key.correct { background: #0080ff; box-shadow: 0 0 10px #0080ff; }

    .setup-overlay { position: absolute; inset: 0; background: var(--bg); z-index: 500; padding: 30px; display: flex; flex-direction: column; overflow-y: auto; }
    .player-line { display: flex; gap: 10px; margin-bottom: 10px; }
    .neon-input { flex: 1; padding: 12px; border-radius: 12px; background: #111; border: 1px solid #333; color: #fff; }

    .footer-bar { height: 40px; display: flex; align-items: center; justify-content: center; border-top: 1px solid rgba(255,255,255,0.05); font-size: 11px; font-weight: 800; color: rgba(255,255,255,0.2); letter-spacing: 1px; }

    .modal { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 40px; text-align: center; }
    .modal.active { display: flex; }
    .big-btn { width: 100%; padding: 16px; border-radius: 15px; background: var(--ai-grad); border: none; color: #fff; font-weight: 900; cursor: pointer; font-size: 16px; margin-top: 20px; }
  </style>
</head>
<body>

  <div class="mobile-frame">
    
    <div class="setup-overlay" id="setup">
      <div class="neon-title">Neon Hangman</div>
      <p style="text-align:center; font-size:12px; opacity:0.5;">OYUNCULARI EKLE</p>
      <div id="pContainer">
        <div class="player-line"><input type="text" class="neon-input p-in" placeholder="1. Oyuncu"></div>
      </div>
      <button onclick="addP()" style="background:none; border:1px dashed #444; color:#888; padding:10px; border-radius:10px; margin-bottom:20px;">+ OYUNCU EKLE</button>
      
      <div style="margin-bottom:20px;">
        <p style="font-size:11px; font-weight:800; opacity:0.6;">Dƒ∞L VE ZORLUK</p>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
          <select id="langSel" class="neon-input"><option value="en">English</option><option value="de">Deutsch</option></select>
          <select id="diffSel" class="neon-input"><option value="8">Kolay (8)</option><option value="6">Orta (6)</option><option value="4">Zor (4)</option></select>
        </div>
      </div>
      <button class="big-btn" onclick="start()">BA≈ûLAT</button>
    </div>

    <div class="neon-title" style="font-size: 20px;">Neon Hangman</div>

    <div class="hangman-area">
      <div class="stage">
        <div class="p p1"></div><div class="p p2"></div><div class="p p3"></div>
        <div class="p p4"></div><div class="p p5"></div><div class="p p6"></div>
        <div class="p p7"></div><div class="p p8"></div><div class="p p9"></div>
      </div>
    </div>

    <div class="lives-row" id="hearts"></div>

    <div class="tr-box" id="trMean">...</div>
    <div class="word-display" id="wordGrid"></div>

    <div style="padding: 0 20px; display: flex; gap: 10px;">
        <div id="turnInfo" style="font-size: 12px; font-weight: 800; color: var(--neon-blue);">SIRA: --</div>
        <button onclick="useHint()" id="jokerBtn" style="flex:1; background:none; border:1px solid var(--neon-pink); color:var(--neon-pink); font-size:10px; border-radius:5px; cursor:pointer;">JOKER (3)</button>
    </div>

    <div class="keyboard" id="kb"></div>

    <div class="footer-bar">italkyAI By Ozyigit‚Äôs 2026</div>

    <div class="modal" id="modal">
      <h1 id="mTitle">Bƒ∞LDƒ∞N!</h1>
      <h2 id="mWord" style="color:var(--neon-blue);">APPLE</h2>
      <p id="mTr">(Elma)</p>
      <button class="big-btn" onclick="next()">DEVAM ET</button>
    </div>

  </div>

  <script type="module">
    import { loadLangPool, createUsedSet, pick } from "/js/langpool.js";

    let pool, used, players = [], curPIdx = 0, wordsDone = 0;
    let target, guessed = [], mistakes = 0, maxM = 8, jokers = 3;

    window.addP = () => {
      const line = document.createElement('div'); line.className = 'player-line';
      line.innerHTML = `<input type="text" class="neon-input p-in" placeholder="Oyuncu"> <button onclick="this.parentElement.remove()" style="background:none; border:none; color:red;">üóëÔ∏è</button>`;
      document.getElementById('pContainer').appendChild(line);
    }

    window.start = async () => {
      const ins = document.querySelectorAll('.p-in');
      ins.forEach(i => { if(i.value.trim()) players.push({n: i.value.trim(), s: 0}); });
      if(!players.length) return alert("ƒ∞sim yaz!");
      
      const lang = document.getElementById('langSel').value;
      maxM = parseInt(document.getElementById('diffSel').value);
      pool = await loadLangPool(lang);
      used = createUsedSet(`used_${lang}`).used;
      
      document.getElementById('setup').style.display = 'none';
      startTurn(0);
    }

    function startTurn(idx) {
      curPIdx = idx; wordsDone = 0; jokers = 3;
      document.getElementById('turnInfo').innerText = `SIRA: ${players[idx].n.toUpperCase()}`;
      loadWord();
    }

    function loadWord() {
      const items = pick(pool, 1, used, null, (x) => x.w.length >= 5);
      target = items[0];
      guessed = []; mistakes = 0;
      updateUI();
      renderKB();
    }

    function updateUI() {
      document.getElementById('wordGrid').innerHTML = target.w.split('').map(l => `<div class="slot">${guessed.includes(l.toUpperCase())?l.toUpperCase():''}</div>`).join('');
      document.getElementById('trMean').innerText = target.tr;
      document.getElementById('jokerBtn').innerText = `JOKER (${jokers})`;
      
      // √áizim
      document.querySelectorAll('.p').forEach((p, i) => p.classList.toggle('show', i < mistakes));
      
      // Kalpler
      let hHtml = "";
      for(let i=0; i<maxM; i++) hHtml += `<span class="heart ${i >= (maxM - mistakes) ? 'lost' : ''}">‚ù§Ô∏è</span>`;
      document.getElementById('hearts').innerHTML = hHtml;
    }

    function renderKB() {
      const abc = "ABCDEFGHIJKLMNOPQRSTUVWXYZ√úƒû≈ûƒ∞√ñ√á".split('');
      const wordChars = [...new Set(target.w.toUpperCase().split(''))];
      let keys = [...wordChars];
      const others = abc.filter(l => !keys.includes(l));
      for(let i=0; i<10; i++) keys.push(others.splice(Math.floor(Math.random()*others.length), 1)[0]);
      document.getElementById('kb').innerHTML = keys.sort((a,b)=>a.localeCompare(b)).map(l => `<button class="key" onclick="guess('${l}', this)">${l}</button>`).join('');
    }

    window.guess = (l, btn) => {
      if(guessed.includes(l) || mistakes >= maxM) return;
      if(target.w.toUpperCase().includes(l)) {
        guessed.push(l); btn.classList.add('correct');
        if(target.w.split('').every(c => guessed.includes(c.toUpperCase()))) finish(true);
      } else {
        mistakes++; btn.classList.add('wrong');
        if(mistakes >= maxM) finish(false);
      }
      updateUI();
    }

    window.useHint = () => {
      if(jokers <= 0) return;
      const rem = target.w.toUpperCase().split('').filter(l => !guessed.includes(l));
      if(rem.length) { jokers--; guess(rem[0], null); }
    }

    function finish(win) {
      const m = document.getElementById('modal');
      document.getElementById('mTitle').innerText = win ? "Bƒ∞LDƒ∞N! üéâ" : "Bƒ∞LEMEDƒ∞N! üíÄ";
      document.getElementById('mWord').innerText = target.w.toUpperCase();
      document.getElementById('mTr').innerText = `(${target.tr})`;
      m.classList.add('active');
      
      const utterance = new SpeechSynthesisUtterance(target.w);
      utterance.lang = document.getElementById('langSel').value === 'en' ? 'en-US' : 'de-DE';
      speechSynthesis.speak(utterance);
    }

    window.next = () => {
      document.getElementById('modal').classList.remove('active');
      wordsDone++;
      if(wordsDone >= 5) {
        if(curPIdx < players.length - 1) startTurn(curPIdx + 1);
        else location.reload();
      } else loadWord();
    }
  </script>
</body>
</html>
