<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ITALKY ‚Ä¢ Glitch Hunter</title>
  <link rel="icon" href="data:," />
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">
  <style>
    /* --- TEMA: SYSTEM GLITCH --- */
    :root {
      --bg: #050505;
      --cyan: #00ffff;
      --pink: #ff0055;
      --green: #00ff66;
      --panel: rgba(10, 20, 20, 0.95);
      --border: rgba(0, 255, 255, 0.3);
      --text: #e0fbfc;
    }

    * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; outline: none; }
    html, body { margin: 0; width: 100%; height: 100%; overflow: hidden; position: fixed; font-family: 'Share Tech Mono', monospace; background: var(--bg); color: var(--text); display: flex; align-items: center; justify-content: center; }

    /* Matrix Rain Efekti (Basit CSS) */
    .matrix-bg {
      position: absolute; inset: 0; 
      background: linear-gradient(180deg, rgba(0,255,255,0.05) 0%, transparent 50%, rgba(255,0,85,0.05) 100%);
      background-size: 100% 200%;
      animation: scanline 5s linear infinite;
      z-index: 0; pointer-events: none;
    }
    @keyframes scanline { 0% {background-position: 0 0;} 100% {background-position: 0 200%;} }

    .mobile-frame {
      width: 100%; max-width: 480px; height: 100%; position: relative; z-index: 10;
      display: flex; flex-direction: column; background: var(--panel);
      border: 1px solid var(--border); box-shadow: 0 0 20px rgba(0,255,255,0.1);
    }
    @media(min-width: 520px) { .mobile-frame { height: 92vh; border-radius: 20px; } }

    /* HEADER */
    .header { flex: 0 0 70px; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); background: rgba(0,0,0,0.5); }
    .nav-btn { width: 40px; height: 40px; background: rgba(0,255,255,0.1); border: 1px solid var(--cyan); color: var(--cyan); display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; transition: 0.1s; clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%); }
    .nav-btn:active { background: var(--cyan); color: #000; transform: scale(0.95); }
    
    .page-title { font-size: 20px; letter-spacing: 2px; color: var(--cyan); text-shadow: 2px 0 var(--pink); animation: glitchText 3s infinite; }
    @keyframes glitchText { 
      0% { text-shadow: 2px 0 var(--pink); } 
      95% { text-shadow: 2px 0 var(--pink); transform: skew(0deg); }
      96% { text-shadow: -2px 0 var(--green); transform: skew(10deg); }
      97% { text-shadow: 2px 0 var(--pink); transform: skew(-10deg); }
      100% { text-shadow: 2px 0 var(--pink); transform: skew(0deg); }
    }
    .lang-badge { font-size: 10px; padding: 2px 6px; background: var(--cyan); color: #000; margin-left: 8px; font-weight: bold; }

    /* OYUN ALANI */
    .game-area { flex: 1; padding: 20px; display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden; }

    /* STATS */
    .stats-bar { display: flex; justify-content: space-between; font-size: 14px; color: var(--cyan); margin-bottom: 20px; opacity: 0.8; }
    
    /* SORU KARTI (TERMƒ∞NAL) */
    .terminal-card {
      flex: 1; border: 2px solid var(--border);
      background: rgba(0,0,0,0.6);
      padding: 20px; position: relative;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      margin-bottom: 30px;
      box-shadow: inset 0 0 30px rgba(0,255,255,0.05);
    }
    .terminal-header {
      position: absolute; top: 0; left: 0; right: 0; height: 24px;
      background: rgba(0,255,255,0.1); border-bottom: 1px solid var(--border);
      display: flex; align-items: center; padding: 0 10px; font-size: 10px; color: var(--cyan);
    }
    .sentence-text {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 24px; line-height: 1.4; text-align: center; color: #fff;
      text-shadow: 0 0 5px rgba(255,255,255,0.5);
    }
    
    /* BUTONLAR */
    .controls { display: flex; gap: 15px; height: 120px; }
    .action-btn {
      flex: 1; border: none; outline: none; cursor: pointer;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      font-family: 'Share Tech Mono', monospace; font-size: 18px; font-weight: bold;
      transition: 0.2s; position: relative; overflow: hidden;
      clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%);
    }
    
    .btn-bug {
      background: rgba(255, 0, 85, 0.15); border: 2px solid var(--pink); color: var(--pink);
    }
    .btn-bug:active { background: var(--pink); color: #fff; box-shadow: 0 0 20px var(--pink); }

    .btn-stable {
      background: rgba(0, 255, 102, 0.15); border: 2px solid var(--green); color: var(--green);
    }
    .btn-stable:active { background: var(--green); color: #000; box-shadow: 0 0 20px var(--green); }

    .icon-big { font-size: 40px; margin-bottom: 5px; }

    /* GLITCH EFEKTLERƒ∞ */
    .screen-glitch { animation: glitchScreen 0.3s; }
    @keyframes glitchScreen {
      0% { filter: hue-rotate(0deg); transform: translate(0); }
      20% { filter: hue-rotate(90deg); transform: translate(-5px, 5px); }
      40% { filter: hue-rotate(-90deg); transform: translate(5px, -5px); }
      60% { filter: invert(1); }
      100% { filter: none; transform: translate(0); }
    }

    /* MODAL */
    .modal-wrap { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 99; display: flex; align-items: center; justify-content: center; }
    .modal-card { width: 85%; max-width: 320px; background: #080808; border: 1px solid var(--cyan); padding: 30px; text-align: center; box-shadow: 0 0 30px rgba(0,255,255,0.2); }
    
    .lang-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin-top: 20px; }
    .lang-btn {
      background: rgba(0,255,255,0.1); border: 1px solid var(--cyan); color: var(--cyan);
      padding: 10px 0; cursor: pointer; font-weight: bold; transition: 0.2s;
    }
    .lang-btn:hover, .lang-btn:active { background: var(--cyan); color: #000; }

    .btn-main {
      width: 100%; padding: 15px; margin-top: 20px;
      background: var(--cyan); color: #000; font-weight: 900; font-size: 18px;
      border: none; cursor: pointer; text-transform: uppercase; font-family: 'Share Tech Mono', monospace;
      box-shadow: 0 0 15px var(--cyan); clip-path: polygon(5% 0, 100% 0, 100% 85%, 95% 100%, 0 100%, 0 15%);
    }

    /* TOAST (Bildirim) */
    .system-msg {
      position: absolute; bottom: 150px; left: 20px; right: 20px;
      background: rgba(0,0,0,0.9); border: 1px solid #fff;
      padding: 15px; color: #fff; font-size: 13px;
      display: none; align-items: center; gap: 10px;
      box-shadow: 0 10px 30px #000; z-index: 50;
    }
    .system-msg.show { display: flex; animation: slideUp 0.3s; }
    .system-msg.success { border-color: var(--green); color: var(--green); }
    .system-msg.fail { border-color: var(--pink); color: var(--pink); }

    @keyframes slideUp { from{transform:translateY(20px); opacity:0} to{transform:translateY(0); opacity:1} }
    .hidden { display: none !important; }
  </style>
</head>
<body>

  <div class="matrix-bg"></div>

  <div class="mobile-frame" id="frame">
    <div class="header">
      <div class="nav-btn" onclick="location.href='/pages/game.html'">‚Üê</div>
      <div class="page-title">GLITCH_HUNTER <span id="langBadge" class="lang-badge">EN</span></div>
      <div class="nav-btn" onclick="toggleSound()" id="soundIcon">üîä</div>
    </div>

    <div class="game-area" id="gameScreen" style="display:none">
      <div class="stats-bar">
        <span>SCORE: <span id="scoreVal">0</span></span>
        <span>INTEGRITY: <span id="livesVal">100%</span></span>
      </div>

      <div class="terminal-card" id="cardEl">
        <div class="terminal-header">/// SYSTEM_CHECK_V.2.0 ///</div>
        <div class="sentence-text" id="sentenceText">LOADING...</div>
      </div>

      <div class="controls">
        <button class="action-btn btn-bug" onclick="checkAnswer(false)">
          <span class="icon-big">üêû</span>
          GLITCH (HATA)
        </button>
        <button class="action-btn btn-stable" onclick="checkAnswer(true)">
          <span class="icon-big">üõ°Ô∏è</span>
          STABLE (DOƒûRU)
        </button>
      </div>
      
      <div class="system-msg" id="sysMsg">
        <div id="sysIcon">‚ö†Ô∏è</div>
        <div style="flex:1">
          <strong id="sysTitle">SYSTEM ERROR</strong><br>
          <span id="sysDesc" style="opacity:0.8">...</span>
        </div>
      </div>

    </div>
  </div>

  <div class="modal-wrap" id="startModal">
    <div class="modal-card">
      <h2 style="color:var(--cyan); margin:0; font-family:'Share Tech Mono'">SYSTEM BOOT</h2>
      <p style="color:#fff; opacity:0.7; font-size:13px; margin-top:10px">Gramer hatalarƒ±nƒ± bul ve sistemi temizle.</p>
      
      <div class="lang-grid">
        <div class="lang-btn" onclick="selectLang('en')">EN</div>
        <div class="lang-btn" onclick="selectLang('de')">DE</div>
        <div class="lang-btn" onclick="selectLang('fr')">FR</div>
        <div class="lang-btn" onclick="selectLang('es')">ES</div>
        <div class="lang-btn" onclick="selectLang('it')">IT</div>
      </div>
    </div>
  </div>

  <div class="modal-wrap hidden" id="endModal">
    <div class="modal-card">
      <h2 style="color:var(--pink); margin:0;">SYSTEM CRASH</h2>
      <div style="font-size:14px; opacity:0.8; margin:15px 0;">
        Skorun: <strong id="finalScore" style="color:#fff">0</strong><br>
        Sistem Durumu: KRƒ∞Tƒ∞K
      </div>
      <button class="btn-main" onclick="restartGame()">REBOOT SYSTEM</button>
      <button class="btn-main" style="background:transparent; border:1px solid var(--cyan); color:var(--cyan)" onclick="location.href='/pages/game.html'">LOGOUT</button>
    </div>
  </div>

<script>
// --- OFFLINE DATABASE (Grammar Mistakes) ---
// Yapƒ±: { t: "C√ºmle", ok: true/false, fix: "Doƒürusu" }
const GLITCH_DB = {
  en: [
    { t: "She don't like pizza.", ok: false, fix: "She doesn't like pizza." },
    { t: "I am happy today.", ok: true, fix: "Correct!" },
    { t: "He play football every day.", ok: false, fix: "He plays football every day." },
    { t: "Where are you going?", ok: true, fix: "Correct!" },
    { t: "They was at the park.", ok: false, fix: "They were at the park." },
    { t: "I have two money.", ok: false, fix: "I have some money / two dollars." },
    { t: "She is taller than me.", ok: true, fix: "Correct!" },
    { t: "He goed to school.", ok: false, fix: "He went to school." },
    { t: "Do you like music?", ok: true, fix: "Correct!" },
    { t: "I must to go.", ok: false, fix: "I must go." }
  ],
  de: [
    { t: "Ich habe ein Hund.", ok: false, fix: "Ich habe einen Hund." },
    { t: "Das Wetter ist sch√∂n.", ok: true, fix: "Richtig!" },
    { t: "Er gehe nach Hause.", ok: false, fix: "Er geht nach Hause." },
    { t: "Wir sind Freunde.", ok: true, fix: "Richtig!" },
    { t: "Das ist ein Tisch.", ok: true, fix: "Richtig!" },
    { t: "Ich bin nach Berlin gefahren.", ok: true, fix: "Richtig!" }
  ],
  fr: [
    { t: "Je suis un √©tudiant.", ok: false, fix: "Je suis √©tudiant." },
    { t: "Il a beaucoup de amis.", ok: false, fix: "Il a beaucoup d'amis." },
    { t: "Elle est belle.", ok: true, fix: "Correct !" },
    { t: "Nous allons au cin√©ma.", ok: true, fix: "Correct !" },
    { t: "J'ai all√© au march√©.", ok: false, fix: "Je suis all√© au march√©." }
  ],
  es: [
    { t: "La agua est√° fr√≠a.", ok: false, fix: "El agua est√° fr√≠a." },
    { t: "Soy muy feliz.", ok: false, fix: "Estoy muy feliz." },
    { t: "Me gusta los gatos.", ok: false, fix: "Me gustan los gatos." },
    { t: "Ella es mi amiga.", ok: true, fix: "Correcto!" },
    { t: "Tengo veinte a√±os.", ok: true, fix: "Correcto!" }
  ],
  it: [
    { t: "Io sono italiano.", ok: true, fix: "Corretto!" },
    { t: "La problema √® difficile.", ok: false, fix: "Il problema √® difficile." },
    { t: "Mi piace la pizza.", ok: true, fix: "Corretto!" },
    { t: "Loro sono a casa.", ok: true, fix: "Corretto!" },
    { t: "Ho andato a Roma.", ok: false, fix: "Sono andato a Roma." }
  ]
};

// --- STATE ---
let currentLang = 'en';
let currentItem = null;
let score = 0;
let lives = 3; // %100, %66, %33, %0
let isMuted = false;
let isBusy = false;

// --- INIT ---
function selectLang(l) {
  currentLang = l;
  document.getElementById('langBadge').innerText = l.toUpperCase();
  document.getElementById('startModal').style.display = 'none';
  document.getElementById('gameScreen').style.display = 'flex';
  restartGame();
}

function restartGame() {
  document.getElementById('endModal').classList.add('hidden');
  score = 0;
  lives = 3;
  updateUI();
  nextQuestion();
}

function nextQuestion() {
  const pool = GLITCH_DB[currentLang] || GLITCH_DB.en;
  currentItem = pool[Math.floor(Math.random() * pool.length)];
  
  // Glitch animasyonu ile metni deƒüi≈ütir
  const textEl = document.getElementById('sentenceText');
  textEl.style.opacity = 0;
  setTimeout(() => {
    textEl.innerText = currentItem.t;
    textEl.style.opacity = 1;
    playSFX('type');
  }, 200);

  hideMsg();
  isBusy = false;
}

// --- KONTROL ---
function checkAnswer(userSaysStable) {
  if (isBusy) return;
  isBusy = true;

  const actuallyStable = currentItem.ok;
  
  // Analiz: Kullanƒ±cƒ± Doƒüru mu Bildi?
  // Kullanƒ±cƒ± "Stable" dedi VE c√ºmle ger√ßekten "Stable" -> DOƒûRU
  // Kullanƒ±cƒ± "Bug" dedi VE c√ºmle ger√ßekten "Bug" -> DOƒûRU
  
  if (userSaysStable === actuallyStable) {
    // --- KULLANICI KAZANDI ---
    playSFX('correct');
    score += 100;
    
    // Eƒüer c√ºmle hataliysa ve biz hatayƒ± bulduysak -> Doƒürusunu g√∂ster
    if (!actuallyStable) {
      showMsg('success', 'PATCH APPLIED ‚úÖ', `Doƒürusu: ${currentItem.fix}`);
      speak(currentItem.fix);
    } else {
      showMsg('success', 'SYSTEM STABLE üõ°Ô∏è', 'G√ºvenlik doƒürulandƒ±.');
    }

    setTimeout(nextQuestion, 2000);

  } else {
    // --- KULLANICI KAYBETTƒ∞ ---
    lives--;
    updateUI();
    playSFX('wrong');
    triggerGlitch(); // Ekranƒ± titret

    if (lives <= 0) {
      showMsg('fail', 'SYSTEM FAILURE üíÄ', 'Kritik hata!');
      setTimeout(endGame, 1000);
    } else {
      showMsg('fail', 'ACCESS DENIED ‚ùå', actuallyStable ? "Hata yoktu!" : "Bir hata vardƒ±!");
      setTimeout(nextQuestion, 1500);
    }
  }
}

// --- UI HELPERS ---
function updateUI() {
  document.getElementById('scoreVal').innerText = score;
  let integrity = Math.round((lives / 3) * 100);
  let color = integrity > 60 ? '#00ff66' : (integrity > 30 ? '#ffff00' : '#ff0055');
  const lv = document.getElementById('livesVal');
  lv.innerText = integrity + "%";
  lv.style.color = color;
}

function showMsg(type, title, desc) {
  const box = document.getElementById('sysMsg');
  box.className = `system-msg show ${type}`;
  document.getElementById('sysTitle').innerText = title;
  document.getElementById('sysDesc').innerText = desc;
  document.getElementById('sysIcon').innerText = type === 'success' ? 'üõ°Ô∏è' : '‚ö†Ô∏è';
}

function hideMsg() {
  document.getElementById('sysMsg').classList.remove('show');
}

function triggerGlitch() {
  document.getElementById('frame').classList.add('screen-glitch');
  setTimeout(() => document.getElementById('frame').classList.remove('screen-glitch'), 300);
}

function endGame() {
  document.getElementById('endModal').classList.remove('hidden');
  document.getElementById('finalScore').innerText = score;
}

// --- AUDIO & TTS ---
const synth = window.speechSynthesis;
let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function toggleSound() {
  isMuted = !isMuted;
  document.getElementById('soundIcon').innerText = isMuted ? "üîá" : "üîä";
}

function playSFX(type) {
  if (isMuted) return;
  if (audioCtx.state === 'suspended') audioCtx.resume();
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  const t = audioCtx.currentTime;

  if (type === 'type') {
    osc.frequency.setValueAtTime(800, t);
    osc.type = 'square';
    gain.gain.setValueAtTime(0.05, t);
    gain.gain.exponentialRampToValueAtTime(0.01, t+0.05);
    osc.start(t); osc.stop(t+0.05);
  } else if (type === 'correct') {
    osc.type = 'sine';
    osc.frequency.setValueAtTime(600, t);
    osc.frequency.linearRampToValueAtTime(1200, t+0.1);
    gain.gain.setValueAtTime(0.1, t);
    gain.gain.linearRampToValueAtTime(0, t+0.3);
    osc.start(t); osc.stop(t+0.3);
  } else if (type === 'wrong') {
    osc.type = 'sawtooth';
    osc.frequency.setValueAtTime(100, t);
    osc.frequency.linearRampToValueAtTime(50, t+0.2);
    gain.gain.setValueAtTime(0.2, t);
    gain.gain.linearRampToValueAtTime(0, t+0.3);
    osc.start(t); osc.stop(t+0.3);
  }
}

function speak(text) {
  if (isMuted) return;
  try {
    synth.cancel();
    const u = new SpeechSynthesisUtterance(text);
    const langMap = { 'en': 'en-US', 'de': 'de-DE', 'fr': 'fr-FR', 'es': 'es-ES', 'it': 'it-IT' };
    u.lang = langMap[currentLang] || 'en-US';
    u.rate = 1.0;
    synth.speak(u);
  } catch(e) {}
}

</script>
</body>
</html>
