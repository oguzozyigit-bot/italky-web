<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
<title>italkyAI â€¢ Dil Dersi SeÃ§imi</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
  #pageContent { height: 100%; overflow: hidden; }
  .wrap { height: 100%; padding: 10px 16px 20px; display: flex; flex-direction: column; }
  .title-area { margin-bottom: 16px; text-align: center; }
  .title-area h2 { font-size: 22px; font-weight: 900; background: linear-gradient(135deg, #fff 0%, #a5b4fc 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
  .grid { flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; grid-auto-rows: var(--cardH); align-content: start; }
  .card { border-radius: 28px; border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.03); backdrop-filter: blur(20px); cursor: pointer; transition: 0.3s; display: flex; flex-direction: column; align-items: center; justify-content: center; }
  .iconWrap { width: var(--iconBox); height: var(--iconBox); border-radius: 20px; display: flex; align-items: center; justify-content: center; background: rgba(99, 102, 241, 0.1); margin-bottom: 8px; }
  .flag { font-size: var(--flagSize); }
  .role { font-size: var(--roleSize); font-weight: 800; color: #a5b4fc; text-transform: uppercase; }
  .name { font-size: var(--nameSize); font-weight: 900; color: #fff; }
</style>
</head>
<body>
<main id="pageContent">
  <div class="wrap">
    <div class="title-area"><h2>Dil Dersi SeÃ§imi YapÄ±n</h2></div>
    <div class="grid" id="teacherGrid"></div>
  </div>
</main>
<script type="module">
  import { mountShell } from "/js/ui_shell.js";
  import { bootPage } from "/js/ui_guard.js";

  mountShell({ scroll: "none" });
  bootPage({ protectedPage: true, header: { nameId: "userName", picId: "userPic" } });

  const TEACHERS = [
    { id: "jack",    flag: "ðŸ‡¬ðŸ‡§", role: "English",   name: "Jack",    voice: "onyx" },
    { id: "heidi",   flag: "ðŸ‡©ðŸ‡ª", role: "Deutsch",   name: "Heidi",   voice: "shimmer" },
    { id: "claire",  flag: "ðŸ‡«ðŸ‡·", role: "FranÃ§ais",  name: "Claire",  voice: "nova" },
    { id: "diego",   flag: "ðŸ‡ªðŸ‡¸", role: "EspaÃ±ol",   name: "Diego",   voice: "echo" },
    { id: "marco",   flag: "ðŸ‡®ðŸ‡¹", role: "Italiano",  name: "Marco",   voice: "fable" },
    { id: "elena",   flag: "ðŸ‡·ðŸ‡º", role: "PÑƒÑÑÐºÐ¸Ð¹",   name: "Elena",   voice: "alloy" },
    { id: "kenji",   flag: "ðŸ‡¯ðŸ‡µ", role: "æ—¥æœ¬èªž",     name: "Kenji",   voice: "onyx" },
    { id: "mei",     flag: "ðŸ‡¨ðŸ‡³", role: "ä¸­æ–‡",       name: "Mei-Ling",voice: "shimmer" }
  ];

  function render() {
    const grid = document.getElementById("teacherGrid");
    grid.innerHTML = TEACHERS.map(t => `
      <div class="card" data-id="${t.id}" data-voice="${t.voice}">
        <div class="iconWrap"><div class="flag">${t.flag}</div></div>
        <div class="role">${t.role}</div>
        <div class="name">${t.name}</div>
      </div>`).join("");

    grid.querySelectorAll(".card").forEach(c => {
      c.addEventListener("click", () => {
        const tid = c.getAttribute("data-id");
        localStorage.setItem("italky_teacher_pref", tid);
        localStorage.setItem("italky_voice_pref", c.getAttribute("data-voice"));
        
        const hasLevel = localStorage.getItem(`italky_level_${tid}`);
        // ðŸš© DOÄžRU AKIÅž: Seviye yoksa Intro'ya (3. sayfa), varsa Plan'a (5. sayfa)
        location.href = hasLevel ? "/pages/plan_select.html" : "/pages/level_test_intro.html";
      });
    });
  }

  function fit() {
    const h = document.querySelector(".premium-header")?.offsetHeight || 0;
    const f = document.querySelector(".premium-footer")?.offsetHeight || 0;
    const usable = window.innerHeight - h - f - 120;
    const cardH = Math.floor(usable / 4.2);
    document.documentElement.style.setProperty("--cardH", cardH + "px");
    document.documentElement.style.setProperty("--iconBox", (cardH * 0.4) + "px");
    document.documentElement.style.setProperty("--flagSize", (cardH * 0.2) + "px");
    document.documentElement.style.setProperty("--roleSize", (cardH * 0.08) + "px");
    document.documentElement.style.setProperty("--nameSize", (cardH * 0.13) + "px");
  }

  render();
  requestAnimationFrame(fit);
  window.addEventListener("resize", fit);
</script>
</body>
</html>
