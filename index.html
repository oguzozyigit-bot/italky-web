<!-- FILE: italky-web/index.html -->
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>ITALKY - Giriş</title>

  <link rel="icon" href="data:," />

  <!-- Google GSI -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <style>
    :root{
      --navy-0:#05070d;
      --navy-1:#081126;
      --navy-2:#0b1834;

      --maroon-1:#3a0b18;
      --maroon-2:#5a1226;

      --white: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.62);
      --border: rgba(255,255,255,.10);

      --it-green:#0f7a3a;
      --it-white:#ffffff;
      --it-red:#b9142a;

      --frameW: min(480px, calc(100vw - 18px));
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
    html,body{ margin:0; padding:0; width:100%; height:100dvh; overflow:hidden; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif; }

    body{
      background:
        radial-gradient(900px 480px at 20% 10%, rgba(90,18,38,.32), transparent 60%),
        radial-gradient(900px 480px at 80% 20%, rgba(11,24,52,.55), transparent 62%),
        radial-gradient(800px 420px at 50% 92%, rgba(255,255,255,.05), transparent 60%),
        linear-gradient(180deg, var(--navy-0), var(--navy-1));
      color: var(--white);
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .mobile-frame{
      width:100%;
      max-width:480px;
      height:100%;
      background: rgba(0,0,0,.22);
      position:relative;
      overflow:hidden;
    }

    @media (min-width:520px){
      .mobile-frame{
        height: 92vh;
        margin-top: 4vh;
        border-radius: 26px;
        border: 1px solid rgba(255,255,255,.10);
        box-shadow: 0 40px 120px rgba(0,0,0,.65);
      }
    }

    /* TOP BAR */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 50;
      height: 68px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 10px 12px;
      background: rgba(0,0,0,.35);
      border-bottom: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
    }

    .brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 6px;
      user-select:none;
    }

    .logoText{
      font-weight: 1000;
      letter-spacing: .6px;
      font-size: 28px;
      line-height: 1;
      color: rgba(255,255,255,.95);
    }

    /* Bayrak: ITALKY yazısının ALTINDA */
    .flagbar{
      width: 170px;
      height: 10px;
      border-radius: 999px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
    }
    .flagbar .g{ width:33.33%; height:100%; float:left; background: var(--it-green); }
    .flagbar .w{ width:33.33%; height:100%; float:left; background: var(--it-white); }
    .flagbar .r{ width:33.33%; height:100%; float:left; background: var(--it-red); }

    /* MAIN STAGE */
    .stage{
      position: relative;
      height: calc(100% - 68px);
      padding: 16px 14px 118px;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      gap: 14px;
    }

    .heroCard{
      width: min(460px, 92vw);
      border-radius: 26px;
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 360px at 20% 0%, rgba(90,18,38,.42), transparent 60%),
        radial-gradient(900px 360px at 85% 10%, rgba(11,24,52,.55), transparent 62%),
        rgba(0,0,0,.22);
      box-shadow: 0 34px 120px rgba(0,0,0,.60);
      backdrop-filter: blur(12px);
      padding: 16px 16px 14px;
      margin-top: 10px;
    }

    .heroTitle{
      font-weight: 1000;
      font-size: 15px;
      letter-spacing:.2px;
      margin: 0;
    }
    .heroDesc{
      margin: 8px 0 0;
      font-weight: 800;
      font-size: 12px;
      color: rgba(255,255,255,.70);
      line-height: 1.35;
    }

    .pillRow{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.78);
      font-weight: 900;
      font-size: 11px;
      white-space:nowrap;
    }
    .dot{
      width:8px; height:8px; border-radius:99px;
      background: rgba(255,255,255,.85);
      box-shadow: 0 0 12px rgba(255,255,255,.14);
      opacity:.9;
    }

    /* BUTTONS */
    .btnWrap{
      width: min(460px, 92vw);
      display:flex;
      flex-direction:column;
      gap: 12px;
      margin-top: 12px;
    }

    .btn3d{
      width:100%;
      height: 58px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color:#fff;
      font-weight: 1000;
      font-size: 15px;
      letter-spacing:.15px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 12px;
      box-shadow: 0 18px 45px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.12);
      user-select:none;
      transition: transform .12s ease, filter .12s ease;
    }
    .btn3d:active{ transform: translateY(1px); filter: brightness(.98); }

    .badge{
      width:34px; height:34px;
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow: 0 12px 26px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.10);
    }
    .badge.google{ background:#fff; border-color: rgba(255,255,255,.18); }
    .badge.google svg{ width:18px; height:18px; display:block; }
    .badge.apple svg{ width:18px; height:18px; display:block; fill:#fff; opacity:.95; }

    /* Google GSI overlay button */
    .googleOverlay{
      position: relative;
      width:100%;
      height:58px;
    }
    #googleBtnWrap{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index: 50;
      opacity: 0.01;
      cursor:pointer;
    }
    #googleBtnWrap iframe{
      width:100% !important;
      height:100% !important;
      pointer-events:auto !important;
      cursor:pointer !important;
    }

    .hint{
      width: min(460px, 92vw);
      margin-top: 4px;
      text-align:center;
      font-size: 11px;
      font-weight: 850;
      color: rgba(255,255,255,.55);
    }

    /* FOOTER BAR */
    .footerbar{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      width: var(--frameW);
      bottom: 0;
      z-index: 60;
      background: rgba(0,0,0,.40);
      border-top: 1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
      padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
      display:flex;
      flex-direction:column;
      gap: 8px;
    }
    .links{
      display:flex;
      justify-content:center;
      gap:16px;
      flex-wrap:wrap;
      font-size: 12px;
      font-weight: 950;
    }
    .links a{
      color: rgba(255,255,255,.70);
      text-decoration:none;
      white-space:nowrap;
    }
    .footerBrand{
      text-align:center;
      font-size: 11px;
      font-weight: 900;
      color: rgba(255,255,255,.58);
      letter-spacing:.2px;
    }

    /* TERMS OVERLAY */
    .full-overlay{
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: rgba(0,0,0,.82);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .full-overlay.active{ display:flex; }

    .terms-card{
      width: min(520px, 92vw);
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(10,10,12,.96);
      box-shadow: 0 40px 140px rgba(0,0,0,.70);
      overflow:hidden;
    }
    .terms-head{
      padding: 14px 14px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      font-weight: 1000;
      color:#fff;
    }
    .x-btn{
      width:40px; height:40px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color:#fff;
      font-size: 20px;
      cursor:pointer;
    }
    #termsFrame{
      width:100%;
      height: 330px;
      border:0;
      background:#fff;
    }
    .agreement{
      padding: 12px 14px 14px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .agree-row{
      display:flex;
      gap:10px;
      align-items:center;
      font-size: 12px;
      font-weight: 900;
      color: rgba(255,255,255,.82);
    }
    .agree-row input{ width:18px; height:18px; }
    #termsAcceptBtn{
      width:100%;
      height: 48px;
      border-radius: 16px;
      border:none;
      background: linear-gradient(135deg, rgba(90,18,38,.95), rgba(11,24,52,.95));
      color:#fff;
      font-weight: 1000;
      cursor:pointer;
      opacity:.65;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 16px 38px rgba(0,0,0,.55);
    }
    #termsAcceptBtn.enabled{ opacity:1; }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      top: 86px;
      transform: translateX(-50%);
      z-index: 99999;
      max-width: min(460px, calc(100vw - 24px));
      background: rgba(20,20,20,.94);
      border: 1px solid rgba(255,255,255,.14);
      border-left: 3px solid rgba(255,255,255,.22);
      color: rgba(255,255,255,.92);
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: 0 18px 50px rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      font-weight: 950;
      font-size: 12px;
      opacity: 0;
      transition: opacity .18s ease, transform .18s ease;
      pointer-events:none;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .toast.show{ opacity:1; transform: translateX(-50%) translateY(0); }
  </style>
</head>

<body>
  <div class="mobile-frame" id="mobileFrame">

    <!-- TOPBAR -->
    <div class="topbar">
      <div class="brand" aria-label="ITALKY">
        <div class="logoText">ITALKY</div>
        <div class="flagbar" aria-hidden="true">
          <div class="g"></div><div class="w"></div><div class="r"></div>
        </div>
      </div>
    </div>

    <!-- STAGE -->
    <div class="stage">

      <div class="heroCard">
        <h2 class="heroTitle">Hızlı çeviri + pratik.</h2>
        <div class="heroDesc">
          Canlı konuşma çevirisi, iki yönlü ekran ve fotoğraftan çeviri modülleri burada.
        </div>

        <div class="pillRow">
          <div class="pill"><span class="dot"></span> Güvenli giriş</div>
          <div class="pill"><span class="dot"></span> Hızlı çeviri</div>
          <div class="pill"><span class="dot"></span> Pratik modlar</div>
        </div>
      </div>

      <div class="btnWrap">

        <!-- GOOGLE (overlay) -->
        <div class="googleOverlay">
          <button class="btn3d" id="googleLoginBtn" type="button">
            <span class="badge google" aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path fill="#EA4335" d="M12 10.2v3.9h5.4c-.2 1.2-1.5 3.4-5.4 3.4-3.3 0-6-2.7-6-6s2.7-6 6-6c1.9 0 3.2.8 3.9 1.5l2.7-2.6C17.9 2.8 15.2 1.5 12 1.5 6.8 1.5 2.5 5.8 2.5 11s4.3 9.5 9.5 9.5c5.5 0 9.1-3.9 9.1-9.3 0-.6-.1-1.1-.1-1.6H12z"/>
                <path fill="#34A853" d="M3.8 7.3l3.2 2.3C7.9 7.3 9.8 5.8 12 5.8c1.9 0 3.2.8 3.9 1.5l2.7-2.6C17.9 2.8 15.2 1.5 12 1.5 8.3 1.5 5.1 3.7 3.8 7.3z"/>
                <path fill="#FBBC05" d="M12 20.5c3.1 0 5.7-1 7.6-2.8l-3.5-2.9c-.9.7-2.1 1.2-4.1 1.2-3.2 0-5.9-2.1-6.8-5l-3.3 2.5c1.4 4.1 5.3 7 10.1 7z"/>
                <path fill="#4285F4" d="M21.1 11.2c0-.6-.1-1.1-.1-1.6H12v3.9h5.4c-.3 1.3-1.1 2.4-2.3 3.1l3.5 2.9c2.1-2 3.3-4.9 3.3-8.3z"/>
              </svg>
            </span>
            Google ile Giriş Yap
          </button>
          <div id="googleBtnWrap"></div>
        </div>

        <!-- APPLE -->
        <button class="btn3d" id="appleLoginBtn" type="button">
          <span class="badge apple" aria-hidden="true">
            <svg viewBox="0 0 24 24">
              <path d="M16.7 13.2c0-2 1.6-3 1.7-3.1-1-1.4-2.6-1.6-3.1-1.6-1.3-.1-2.5.8-3.1.8-.6 0-1.6-.8-2.7-.8-1.4 0-2.7.8-3.4 2.1-1.5 2.6-.4 6.4 1 8.5.7 1 1.5 2.1 2.6 2.1 1 0 1.4-.6 2.7-.6 1.2 0 1.6.6 2.7.6 1.1 0 1.9-1 2.6-2 .8-1.1 1.1-2.2 1.1-2.2-.1 0-2.1-.8-2.1-3.9z"/>
              <path d="M14.6 6.9c.6-.7 1-1.7.9-2.7-.9.1-2 .6-2.6 1.3-.6.6-1.1 1.6-.9 2.6 1 .1 2-.5 2.6-1.2z"/>
            </svg>
          </span>
          Apple ile Giriş Yap
        </button>

      </div>

      <div class="hint">Devam ederek Kullanıcı Sözleşmesi’ni onaylayacaksın.</div>
    </div>

    <!-- FOOTER -->
    <div class="footerbar">
      <div class="links">
        <a href="/pages/about.html">Hakkımızda</a>
        <a href="/pages/faq.html">SSS</a>
        <a href="/pages/privacy.html">Gizlilik</a>
        <a href="/pages/contact.html">İletişim</a>
      </div>
      <div class="footerBrand">ITALKYAI By Ozyigit's 2026</div>
    </div>

  </div>

  <!-- TERMS OVERLAY -->
  <div class="full-overlay" id="termsOverlay">
    <div class="terms-card">
      <div class="terms-head">
        <div>Sözleşme</div>
        <button id="closeTermsBtn" class="x-btn" aria-label="Kapat">×</button>
      </div>

      <iframe id="termsFrame" src="/pages/sozlesme.html" title="Kullanıcı Sözleşmesi"></iframe>

      <div class="agreement">
        <div class="agree-row">
          <input type="checkbox" id="termsCheck" />
          <label for="termsCheck">Onaylıyorum.</label>
        </div>
        <button id="termsAcceptBtn" type="button" disabled>Onayla ve Devam Et</button>
        <div class="footerBrand" style="text-align:center;">ITALKYAI By Ozyigit's 2026</div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">—</div>

  <script type="module">
    // FILE: italky-web/index.html (inline logic)
    import { STORAGE_KEY } from "/js/config.js";
    import { initAuth, acceptTerms, logout } from "/js/auth.js";

    const $ = (id)=>document.getElementById(id);
    const toastEl = $("toast");

    function safeJson(s, fb={}){ try{ return JSON.parse(s||""); }catch{ return fb; } }
    function termsKey(email=""){ return `italky_terms_accepted_at::${String(email||"").toLowerCase().trim()}`; }

    function showToast(msg){
      if(!toastEl) return;
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(window.__t1);
      window.__t1 = setTimeout(()=> toastEl.classList.remove("show"), 2400);
    }

    function hasUser(){
      const u = safeJson(localStorage.getItem(STORAGE_KEY), {});
      return !!(u && u.email && u.isSessionActive);
    }

    function hasAcceptedTerms(){
      const u = safeJson(localStorage.getItem(STORAGE_KEY), {});
      const email = String(u?.email||"").toLowerCase().trim();
      if(!email) return false;
      return !!localStorage.getItem(termsKey(email));
    }

    // ✅ ITALKY’de ilk sayfa neresi olacak?
    // Şimdilik çeviri: /pages/translate.html
    function goHome(){
      window.location.replace("/pages/translate.html");
    }

    // Apple click
    $("appleLoginBtn")?.addEventListener("click", (e)=>{
      e.preventDefault();
      showToast("Apple girişi hazırlanıyor… Şimdilik Google ile devam edebilirsin.");
    });

    // Terms overlay
    const termsOverlay = $("termsOverlay");
    const termsCheck = $("termsCheck");
    const termsAcceptBtn = $("termsAcceptBtn");

    function openTerms(){
      if(!termsOverlay) return;
      termsOverlay.classList.add("active");
      if(termsCheck) termsCheck.checked = false;
      if(termsAcceptBtn){
        termsAcceptBtn.disabled = true;
        termsAcceptBtn.classList.remove("enabled");
      }
    }

    $("closeTermsBtn")?.addEventListener("click", ()=>{
      try{ logout(); }catch{ window.location.replace("/index.html"); }
    });

    if(termsCheck && termsAcceptBtn){
      termsCheck.addEventListener("change", ()=>{
        const ok = !!termsCheck.checked;
        termsAcceptBtn.disabled = !ok;
        termsAcceptBtn.classList.toggle("enabled", ok);
      });
    }

    termsAcceptBtn?.addEventListener("click", async ()=>{
      if(!termsCheck?.checked) return;
      const ok = await acceptTerms();
      if(ok) goHome();
    });

    // Boot
    initAuth();

    if(hasUser()){
      if(hasAcceptedTerms()) goHome();
      else openTerms();
    }
  </script>
</body>
</html>
