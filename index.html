<!-- FILE: italky-web/index.html -->
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>italkyAI • Giriş</title>
  <link rel="icon" href="data:," />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root { --bg:#020205; --text:#fff; --muted:#9ca3af; --ai:linear-gradient(135deg,#a5b4fc 0%,#6366f1 50%,#4338ca 100%); }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;outline:none}
    html,body{margin:0;width:100%;height:100dvh;overflow:hidden;font-family:Outfit,sans-serif;background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center}
    .frame{width:100%;max-width:440px;height:100%;display:flex;flex-direction:column;justify-content:space-between;background:rgba(8,8,12,.85);backdrop-filter:blur(30px);padding:40px 20px}
    .logo{font-size:50px;font-weight:700;text-align:center}
    .ai{background:var(--ai);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    #googleBtnContainer{width:100%;max-width:320px;min-height:44px;display:flex;justify-content:center}
    .toast{position:fixed;top:20px;left:50%;transform:translateX(-50%) translateY(-100px);background:#1a1a2e;border:1px solid #6366f1;padding:12px 16px;border-radius:999px;transition:.3s;z-index:9999;color:#fff;font-weight:800;font-size:12px;max-width:min(92vw,520px);text-align:center}
    .toast.show{transform:translateX(-50%) translateY(0)}
  </style>
</head>
<body>
  <div class="frame">
    <div style="text-align:center">
      <div class="logo">italky<span class="ai">AI</span></div>
      <h2 style="font-size:22px;margin-top:20px;">Hoş Geldiniz</h2>
      <p style="color:var(--muted);font-size:14px;">Devam etmek için giriş yapın.</p>
    </div>

    <div style="display:flex;flex-direction:column;gap:12px;align-items:center;width:100%;">
      <div id="googleBtnContainer"></div>
    </div>

    <div style="text-align:center;font-size:10px;color:rgba(255,255,255,0.2);">italkyAI © 2026</div>
  </div>

  <div id="toast" class="toast"></div>

  <script type="module">
    const HOME_PATH = "/pages/home.html";
    window.showToast = (msg)=>{
      const t=document.getElementById("toast");
      t.textContent=String(msg||"");
      t.classList.add("show");
      clearTimeout(window.__to);
      window.__to=setTimeout(()=>t.classList.remove("show"),2200);
    };

    function waitGoogle(maxMs=9000){
      const t0=Date.now();
      return new Promise((resolve)=>{
        const tick=()=>{
          if(window.google?.accounts?.id) return resolve(true);
          if(Date.now()-t0>maxMs) return resolve(false);
          setTimeout(tick,150);
        };
        tick();
      });
    }

    async function init(){
      let auth=null;
      try{ auth = await import("/js/auth.js?v="+Date.now()); }
      catch(e){ console.error(e); showToast("auth.js yüklenemedi"); return; }

      // login varsa → home
      try{
        const already = auth.redirectIfLoggedIn?.();
        if(already){ location.replace(HOME_PATH); return; }
      }catch{}

      const ok = await waitGoogle();
      if(!ok){ showToast("Google bileşeni yüklenemedi"); return; }

      try{ auth.initAuth?.(); }
      catch(e){ console.error(e); showToast("Giriş başlatılamadı"); }
    }

    window.addEventListener("load", init);
  </script>
</body>
</html>
